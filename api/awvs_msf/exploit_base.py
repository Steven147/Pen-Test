#将通过metasploit search方法找到的模块存储起来
import os

def pick_module(data):
    ret = ''
    prev = ''
    state = 0
    for i in data:
        if prev.isdigit() and i == ' ':
            state = 'prepare'
            prev = i
            continue
        if state == 'start' and i == ' ' and prev.isalpha():
            state = 'stop'
        if state == 'prepare' and prev == ' ':
            state = 'start'
        if state == 'start':
            ret = ret + i
        if state == 'stop':
            break
        prev = i
    return ret.strip(' ')

def save_module(filename):
    filename = "../search.txt"
    exploit_dict = {}
    datas = []
    modules = []
    if os.path.isfile(filename):
        with open(filename) as file_obj:
            for line in file_obj.readlines():
                line = line.rstrip()
                result = ('auxiliary' in line) or ('exploit' in line)
                if result:
                    datas.append(line)
    else :
        print('File does not exists.')

    for data in datas:
        data = pick_module(data)
        modules.append(data)
    return modules

modules = save_module('../search.txt')
print(modules)